[1;33m[INFO][0m Starting qxub conda integration tests...
[1;33m[INFO][0m Setting up test environment...
[1;33m[INFO][0m Backed up existing config
[1;33m[INFO][0m Created test config file
[1;33m[INFO][0m === Testing Basic Conda Functionality ===
[1;33m[INFO][0m Running test: Basic conda command
Command: qxub conda --env base echo 'Hello World'
[0;32m[PASS][0m Basic conda command
                                                                                             
---
[1;33m[INFO][0m Running test: Conda with full PBS options
Command: qxub --name test-job --resources walltime=00:15:00 --resources mem=2GB --resources ncpus=1 --project a56 --queue normal conda --env base echo 'Full options'
[0;32m[PASS][0m Conda with full PBS options
                                                                                             
---
[1;33m[INFO][0m Running test: Conda with storage
Command: qxub --resources storage='scratch/a56+gdata/a56' conda --env base echo 'Storage test'
[0;32m[PASS][0m Conda with storage
                                                                                             
---
[1;33m[INFO][0m Running test: Conda with hours:minutes format
Command: qxub --resources walltime=1:30 conda --env base echo 'Time format test'
[0;32m[PASS][0m Conda with hours:minutes format
                                                                                             
---
[1;33m[INFO][0m Running test: Conda with MB memory
Command: qxub --resources mem=2048MB conda --env base echo 'Memory format test'
[0;32m[PASS][0m Conda with MB memory
                                                                                             
---
[1;33m[INFO][0m === Testing Config Integration ===
[1;33m[INFO][0m Running test: Config defaults
Command: qxub conda --env base echo 'Config defaults test'
[0;32m[PASS][0m Config defaults
                                                                                             
---
[1;33m[INFO][0m Running test: Override config defaults
Command: qxub --name override-test --resources walltime=00:45:00 conda --env base echo 'Override test'
[0;32m[PASS][0m Override config defaults
                                                                                             
---
[1;33m[INFO][0m Running test: Partial config override
Command: qxub --resources mem=6GB conda --env base echo 'Partial override test'
[0;32m[PASS][0m Partial config override
                                                                                             
---
[1;33m[INFO][0m === Testing Alias Functionality ===
[1;33m[INFO][0m Running test: Basic alias execution
Command: qxub alias test-small echo 'Alias test'
[0;32m[PASS][0m Basic alias execution
Output: ğŸƒ Executing alias 'test-small' with command:
   qxub --name small-test --resources walltime=00:15:00 --resources mem=2GB conda --env base echo 'Small test alias' echo Alias test

                                                                                             
---
[1;33m[INFO][0m Running test: Alias with overrides
Command: qxub alias test-small --resources walltime=00:20:00 --resources mem=3GB echo 'Alias override test'
[0;32m[PASS][0m Alias with overrides
Output: ğŸƒ Executing alias 'test-small' with command:
   qxub --name small-test --resources walltime=00:20:00 --resources mem=3GB conda --env base echo 'Small test alias' echo Alias override test

                                                                                             
---
[1;33m[INFO][0m Running test: Large job alias
Command: qxub alias test-large echo 'Large job test'
[0;32m[PASS][0m Large job alias
Output: ğŸƒ Executing alias 'test-large' with command:
   qxub --name large-test --resources walltime=01:00:00 --resources mem=8GB --resources ncpus=2 conda --env myenv echo 'Large test alias' echo Large job test

---
[1;33m[INFO][0m Running test: GPU alias
Command: qxub alias test-gpu echo 'GPU test'
[0;32m[PASS][0m GPU alias
Output: ğŸƒ Executing alias 'test-gpu' with command:
   qxub --name gpu-test --queue gpuvolta --resources ngpus=1 --resources ncpus=12 conda --env tensorflow echo 'GPU test alias' echo GPU test

---
[1;33m[INFO][0m Running test: Alias with extra arguments
Command: qxub alias test-small 'python -c "print(\"Python test\")"'
[0;32m[PASS][0m Alias with extra arguments
Output: ğŸƒ Executing alias 'test-small' with command:
   qxub --name small-test --resources walltime=00:15:00 --resources mem=2GB conda --env base echo 'Small test alias' python -c "print(\"Python test\")"

                                                                                             
---
[1;33m[INFO][0m === Testing Edge Cases ===
[1;33m[INFO][0m Running test: Missing environment
Command: qxub conda echo 'No env specified'
[0;31m[FAIL][0m Missing environment (expected exit code 2, got 0)
                                                                                             
---
[1;33m[INFO][0m Running test: Invalid environment
Command: qxub conda --env nonexistent-env echo 'Invalid env'
[0;32m[PASS][0m Invalid environment
---
[1;33m[INFO][0m Running test: Invalid time format
Command: qxub --resources walltime=invalid-time conda --env base echo 'Bad time'
[0;32m[PASS][0m Invalid time format
Output:  â ‹ â ™ â ¹qsub: Illegal attribute or resource value Resource_List.walltime
---
[1;33m[INFO][0m Running test: Invalid memory format
Command: qxub --resources mem=invalid-mem conda --env base echo 'Bad memory'
[0;32m[PASS][0m Invalid memory format
Output:  â ‹qsub: Illegal attribute or resource value Resource_List.mem
---
[1;33m[INFO][0m Running test: Non-existent alias
Command: qxub alias nonexistent-alias echo 'Bad alias'
[0;32m[PASS][0m Non-existent alias
Output: âŒ Alias 'nonexistent-alias' not found
Available aliases:
  â€¢ test-small
  â€¢ test-large
  â€¢ test-gpu
---
[1;33m[INFO][0m Running test: Empty command
Command: qxub conda --env base
[0;32m[PASS][0m Empty command
Output: Error: Command is required.
---
[1;33m[INFO][0m === Testing Complex Scenarios ===
[1;33m[INFO][0m Running test: Complex command with pipes
Command: qxub conda --env base 'echo "test data" | wc -l > output.txt && cat output.txt'
[0;32m[PASS][0m Complex command with pipes
                                                                                             
---
[1;33m[INFO][0m Running test: Command with special characters
Command: qxub conda --env base 'python -c "print(\"Hello, World!\")"'
[0;32m[PASS][0m Command with special characters
                                                                                             
---
[1;33m[INFO][0m Running test: Multi-line command
Command: qxub conda --env base 'echo "Line 1" && echo "Line 2" && echo "Line 3"'
[0;32m[PASS][0m Multi-line command
Line 2
Line 3
                                                                                             
---
[1;33m[INFO][0m Running test: Command with env vars
Command: qxub conda --env base 'export TEST_VAR=hello && echo $TEST_VAR'
[0;32m[PASS][0m Command with env vars
                                                                                             
---
[1;33m[INFO][0m Running test: Resource intensive job
Command: qxub --resources walltime=00:05:00 --resources mem=1GB --resources ncpus=2 conda --env base 'python -c "import time; time.sleep(1); print(\"Resource test\")"'
[0;32m[PASS][0m Resource intensive job
                                                                                             
---
[1;33m[INFO][0m === Testing Config Variations ===
[1;33m[INFO][0m Running test: Show config
Command: qxub config get
[0;32m[PASS][0m Show config
Output:    1 defaults:                                                                                                                      
   2   name: test-job                                                                                                               
   3   project: a56                                                                                                                 
   4   queue: normal                                                                                                                
   5   resources:                                                                                                                   
   6   - walltime=00:30:00                                                                                                          
   7   - mem=4GB                                                                                                                    
   8   - ncpus=1                                                                                                                    
   9 aliases:                                                                                                                       
  10   test-small:                                                                                                                  
  11     main:                                                                                                                      
  12       name: small-test                                                                                                         
  13       resources:                                                                                                               
  14       - walltime=00:15:00                                                                                                      
  15       - mem=2GB                                                                                                                
  16     subcommand:                                                                                                                
  17       type: conda                                                                                                              
  18       env: base                                                                                                                
  19     target:                                                                                                                    
  20       cmd: echo 'Small test alias'                                                                                             
  21   test-large:                                                                                                                  
  22     main:                                                                                                                      
  23       name: large-test                                                                                                         
  24       resources:                                                                                                               
  25       - walltime=01:00:00                                                                                                      
  26       - mem=8GB                                                                                                                
  27       - ncpus=2                                                                                                                
  28     subcommand:                                                                                                                
  29       type: conda                                                                                                              
  30       env: myenv                                                                                                               
  31     target:                                                                                                                    
  32       cmd: echo 'Large test alias'                                                                                             
  33   test-gpu:                                                                                                                    
  34     main:                                                                                                                      
  35       name: gpu-test                                                                                                           
  36       queue: gpuvolta                                                                                                          
  37       resources:                                                                                                               
  38       - ngpus=1                                                                                                                
  39       - ncpus=12                                                                                                               
  40     subcommand:                                                                                                                
  41       type: conda                                                                                                              
  42       env: tensorflow                                                                                                          
  43     target:                                                                                                                    
  44       cmd: echo 'GPU test alias'                                                                                               
  45                                                                                                                                
---
[1;33m[INFO][0m Running test: Show specific config
Command: qxub config get defaults.name
[0;32m[PASS][0m Show specific config
Output: test-job
---
[1;33m[INFO][0m Running test: List aliases
Command: qxub config alias list-aliases
[0;32m[PASS][0m List aliases
Output:                            Available Aliases                           
â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“
â”ƒ Name       â”ƒ Subcommand â”ƒ Command                 â”ƒ Description     â”ƒ
â”¡â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”©
â”‚ test-gpu   â”‚ conda      â”‚ echo 'GPU test alias'   â”‚ Job: gpu-test   â”‚
â”‚ test-large â”‚ conda      â”‚ echo 'Large test alias' â”‚ Job: large-test â”‚
â”‚ test-small â”‚ conda      â”‚ echo 'Small test alias' â”‚ Job: small-test â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
---
[1;33m[INFO][0m Running test: Alias test (dry run)
Command: qxub config alias test test-small
[0;32m[PASS][0m Alias test (dry run)
Output: ğŸ§ª Testing alias: test-small
âœ… Template resolution successful
âœ… Alias definition is valid
---
[1;33m[INFO][0m Cleaning up test environment...
[1;33m[INFO][0m Restored original config

========================================
           INTEGRATION TEST RESULTS
========================================
Total Tests: 28
Passed: [0;32m27[0m
Failed: [0;31m1[0m

Failed Test Details:
Missing environment: Expected exit 2, got 0

